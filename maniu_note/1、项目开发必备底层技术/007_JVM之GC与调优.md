[TOC]

# JVM之GC与调优

## 什么是垃圾？

垃圾：指在程序中没有任何指针指向的对象，这个对象就是需要被回收的垃圾。
国外定义原文：   An object is considered garbage when it can no longer be reached from any pointer in the running program.

## 什么是GCRoot?

一个指针，他保存了堆里面的对象，但自己又不在堆当中，那么他就是一个Root。

## 垃圾回收相关算法

- 垃圾确认算法--标记阶段算法
  - 引用计数算法
  - GCRoot可达性分析算法
- 垃圾清除算法--清除阶段算法
  - 标记-清除算法
  - 复制算法
  - 标记-压缩算法

### 1、垃圾确认算法

#### 1.1、引用计数算法

![image-20220309101909529](007_JVM之GC与调优.assets/image-20220309101909529.png)

#### 1.2、可达性分析算法

![image-20220309102319573](007_JVM之GC与调优.assets/image-20220309102319573.png)

### 2、垃圾清除算法

#### 2.1、标记-清除算法

![image-20220309103156818](007_JVM之GC与调优.assets/image-20220309103156818.png)

#### 2.2、复制算法

![image-20220309103442700](007_JVM之GC与调优.assets/image-20220309103442700.png)

![image-20220309103830095](007_JVM之GC与调优.assets/image-20220309103830095.png)

#### 2.3、标记-压缩算法

![image-20220309104203152](007_JVM之GC与调优.assets/image-20220309104203152.png)

![image-20220309104408572](007_JVM之GC与调优.assets/image-20220309104408572.png)

#### 2.4、三种算法的性能指标对比

![image-20220309104643575](007_JVM之GC与调优.assets/image-20220309104643575.png)

### 3、分代收集算法

![image-20220309104934667](007_JVM之GC与调优.assets/image-20220309104934667.png)

![image-20220309105356286](007_JVM之GC与调优.assets/image-20220309105356286.png)

### 4、增量收集算法

![image-20220309105725882](007_JVM之GC与调优.assets/image-20220309105725882.png)

### 5、分区算法

![image-20220309105852651](007_JVM之GC与调优.assets/image-20220309105852651.png)

### 6、总结

注意，实际上GC过程要复杂的多，需要考虑的不单单是这些，还有并行与并发的兼顾，而且通常都会应用复合算法去使用

## 垃圾回收器

### 1、常用7种垃圾回收器

<img src="007_JVM之GC与调优.assets/image-20220309110609079.png" alt="image-20220309110609079" />

#### 1.1、CMS垃圾回收器

![image-20220309111202179](007_JVM之GC与调优.assets/image-20220309111202179.png)

![image-20220309111216546](007_JVM之GC与调优.assets/image-20220309111216546.png)

![image-20220309111240286](007_JVM之GC与调优.assets/image-20220309111240286.png)

### 2、垃圾回收的并行与串行

![image-20220309110534105](007_JVM之GC与调优.assets/image-20220309110534105.png)

### 3、常用GC垃圾回收器对比

![image-20220309110708203](007_JVM之GC与调优.assets/image-20220309110708203.png)

### 4、评估GC的性能指标

![image-20220309111329260](007_JVM之GC与调优.assets/image-20220309111329260.png)

## MAT与性能调优

### MAT工具的使用

![image-20220309111514895](007_JVM之GC与调优.assets/image-20220309111514895.png)

### 内存抖动和内存泄漏

![image-20220309111615304](007_JVM之GC与调优.assets/image-20220309111615304.png)

## 附件

### JVM-GC垃圾处理

![image-20220309111615304](007_JVM之GC与调优.assets/JVM-GC垃圾处理.png)

### 优化内存的良好编码习惯

![image-20220309111615304](007_JVM之GC与调优.assets/优化内存的良好编码习惯.png)